<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        
        Write-up: UofTCTF 2026 | Cuýt
        
    </title>
    <link rel="stylesheet" href="/css/normalize.min.css">
    <link rel="stylesheet" href="/css/bootstrap-grid-5.3.8.css">
    <link rel="stylesheet" href="/css/fontawesome-7.1.0/css/all.min.css">
    
    <link rel="stylesheet" href="/css/syntax.min.c75db92330d165065b4cef68bb3da371b54ad6f746e9e9047ea56f286749850b.css" integrity="sha256-x125IzDRZQZbTO9ouz2jcbVK1vdG6ekEfqVvKGdJhQs=">
    <link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/images/favicon.svg" />
    <link rel="shortcut icon" href="/images/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="blog của Cuýt" />
    <link rel="manifest" href="/images/site.webmanifest" />
    <link rel="preload" href="/fonts/JetBrainsMono/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin>
    <script src="/js/fuse.basic.min.js"></script>
    
    <link rel="stylesheet" href="/css/style.min.b95e4bf8bfa151403af9f6edee038ab6dc0b8fad3fc2d645f96ce26467a81979.css" integrity="sha256-uV5L&#43;L&#43;hUUA6&#43;fbt7gOKttwLj60/wtZF&#43;WziZGeoGXk="><meta name="description" content="My write-up for the Lottery (Misc) challenge from UofTCTF 2026, documenting how a simple Bash script can be exploited using arithmetic injection inside a jail …"></head>
<body>
    <main id="main" role="main">
        <header id="main-header">
  <div class="container container-narrow">
    <div class="row align-items-center">
      <div class="col-3 col-md-2 col-lg-3">
        <div class="main-header__homepage">
          <a href="/" class="main-header__hompage-link">Cuýt</a>
        </div>
      </div>

      <div class="col-12 col-md-6 col-lg-6 main-header__navbar-wrapper">
        <nav class="main-header__navbar" aria-label="Main navigation">
          <ul class="main-header__navbar-list">
            <li><a href="/">Blog</a></li>
            <li><a href="/categories">Categories</a></li>
            <li><a href="/archives">Archives</a></li>
            <li><a href="/about">About</a></li>
          </ul>
        </nav>
      </div>

      <div class="col-9 col-md-4 col-lg-3">
        <div class="main-header__btn">
          <div class="main-header_search-wrapper">
            <i class="fa-solid fa-magnifying-glass main-header__search-icon" aria-hidden="true"></i>
            <input type="text" class="main-header__search-box" placeholder="Search..." aria-label="Search">
            <ul id="main_header__search-results"></ul>
          </div>

          <button class="main-header__btn-toggle-theme" type="button" aria-label="Toggle theme">
            <i class="fa-solid fa-moon" aria-hidden="true"></i>
          </button>

          <button class="main-header__btn-mobile-bar" type="button" aria-label="Open menu" aria-expanded="false" aria-controls="main-header-mobile-menu">
            <i class="fa-solid fa-bars" aria-hidden="true"></i>
          </button>
        </div>
      </div>
    </div>

    <div id="main-header-mobile-menu" class="main-header__mobile-menu" hidden>
    <nav aria-label="Mobile navigation">
        <ul class="main-header__mobile-menu-list">
        <li><a href="/">Blog</a></li>
        <li><a href="/categories">Categories</a></li>
        <li><a href="/archives">Archives</a></li>
        <li><a href="/about">About</a></li>
        </ul>
    </nav>
    </div>
  </div>
</header>

        <div id="main-content" class="container container-narrow">
            
    <div class="row">
        <article class="main-content__article-detail col-md-9">
            
                
                <div class="main-content__article-cover">
                    
                        
                        
                        <img src="/2026/01/write-up-uoftctf-2026/cover_hu_630ae303e39066e0.webp" alt="Write-up: UofTCTF 2026">
                    
                </div>
            
        
            <header class="main-content__article-header">
                <h1 class="main-content__article-title">
                    Write-up: UofTCTF 2026
                </h1>
                <div class="main-content__article-meta mt-3">
                    <span>
                        <i class="fa-solid fa-hashtag"></i>
                        
                            
                                
                                <a class="main-content__article-meta-category-link" href="/categories/writeups">
                                    Writeups
                                </a>
                            
                                , 
                                <a class="main-content__article-meta-category-link" href="/categories/security">
                                    Security
                                </a>
                            
                        
                    </span>
                    
                        
                        <span>
                            <i class="fa-regular fa-bookmark"></i>
                            Series
                            <a class="main-content__article-meta-category-link" href="/series/uoftctf-2026">
                            UofTCTF 2026
                            </a>
                            · Part 1
                        </span>
                    
                    <span class=""><i class="fa-regular fa-calendar"></i> 12/01/2026</span>
                    <span class=""><i class="fa-regular fa-clock"></i> 2 mins read</span>
                </div>
            </header>
        
            
            
            
            
            
            
            
            
            
            <div class="main-content__article-body-content">
                <h2 id="chal-1">Chal 1</h2>
<h3 id="description">Description</h3>
<p>Han Shangyan quietly gives away all his savings to protect someone he cares about, leaving himself with nothing.<br>
Now broke, his only hope is chance itself.</p>
<p>Can you help Han Shangyan win the lottery?</p>
<pre tabindex="0"><code>nc 35.245.30.212 5000
</code></pre><p><strong>Author:</strong> SteakEnthusiast, White</p>
<h3 id="source-analysis">Source Analysis</h3>
<p>Inside the provided <code>lottery.zip</code>, we are given a <code>Dockerfile</code>, which shows that the challenge is deployed using the <code>pwn.red/jail</code> framework.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="line"><span class="cl"><span class="k">FROM</span><span class="w"> </span><span class="s">pwn.red/jail</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">COPY</span> --from<span class="o">=</span>ubuntu@sha256:c35e29c9450151419d9448b0fd75374fec4fff364a27f176fb458d472dfc9e54 / /srv<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">RUN</span> mkdir -p /srv/app<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">WORKDIR</span><span class="w"> </span><span class="s">/srv/app</span><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">COPY</span> --chmod<span class="o">=</span><span class="m">555</span> lottery.sh run<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">COPY</span> flag.txt /srv/flag.txt<span class="err">
</span></span></span><span class="line"><span class="cl"><span class="err">
</span></span></span><span class="line"><span class="cl"><span class="k">ENV</span> <span class="nv">JAIL_PIDS</span><span class="o">=</span><span class="m">10</span> <span class="nv">JAIL_MEM</span><span class="o">=</span>10M <span class="nv">JAIL_TIME</span><span class="o">=</span><span class="m">120</span> <span class="nv">JAIL_POW</span><span class="o">=</span><span class="m">10000</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The challenge is <strong>white-boxed</strong>. The following Bash script contains the core logic.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Today&#39;s lottery!&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">echo</span> <span class="s2">&#34;Guess the winning ticket (hex):&#34;</span>
</span></span><span class="line"><span class="cl"><span class="nb">read</span> guess
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[[</span> <span class="s2">&#34;</span><span class="nv">$guess</span><span class="s2">&#34;</span> <span class="o">=</span>~ ^<span class="o">[</span>0-9a-fA-F<span class="o">]</span>+ <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nb">let</span> <span class="s2">&#34;g = 0x</span><span class="nv">$guess</span><span class="s2">&#34;</span> 2&gt;/dev/null
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Invalid guess.&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nb">exit</span> <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">ticket</span><span class="o">=</span><span class="k">$(</span>head -c <span class="m">16</span> /dev/urandom <span class="p">|</span> md5sum <span class="p">|</span> cut -c1-16<span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">let</span> <span class="s2">&#34;t = 0x</span><span class="nv">$ticket</span><span class="s2">&#34;</span> 2&gt;/dev/null
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[[</span> <span class="nv">$g</span> -eq <span class="nv">$t</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    cat /flag.txt
</span></span><span class="line"><span class="cl"><span class="k">else</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="s2">&#34;Not a winner. Better luck next time!&#34;</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="solution">Solution</h3>
<h4 id="breaking-the-random-ticket">Breaking the Random Ticket</h4>
<p>The ticket generation relies on external commands (<code>head</code>, <code>md5sum</code>, and <code>cut</code>), which are resolved through the <code>PATH</code> environment variable.</p>
<p>Because our input is injected into a Bash arithmetic expression using <code>let</code>, we can abuse the comma operator to perform variable assignments.</p>
<p>Payload:</p>
<pre tabindex="0"><code>0,PATH=0
</code></pre><p>This causes:</p>
<ul>
<li><code>PATH</code> to be overwritten,</li>
<li>the random ticket generation pipeline to fail,</li>
<li><code>ticket</code> to become an empty string,</li>
<li>and <code>t</code> to evaluate to <code>0</code>.</li>
</ul>
<p>This allows us to reach the winning branch; however, <code>cat</code> also breaks because it depends on <code>PATH</code>.</p>
<p>
  
  
<figure class="image-container">
  <a href="/2026/01/write-up-uoftctf-2026/image.png" 
     class="lightbox-trigger" 
     >
      <img src="/2026/01/write-up-uoftctf-2026/image_hu_ae044c883d2e2b6b.webp" 
           
             width="954" height="430"
           
           alt="" 
           class="main-content__article-body-img" 
           loading="lazy" 
      />
  </a>
  
  
</figure></p>
<h4 id="bash-arithmetic-injection">Bash Arithmetic Injection</h4>
<p>While researching Bash arithmetic behavior, a similar vulnerability was found in <strong>JSON Bourne (PlaidCTF 2020)</strong>.</p>
<p>Key insight:</p>
<blockquote>
<p>Array indexing inside Bash arithmetic expressions triggers full expansion, including command substitution.</p>
</blockquote>
<p>Example:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="nv">x</span><span class="o">=</span><span class="s1">&#39;__[$(id)]&#39;</span>
</span></span><span class="line"><span class="cl"><span class="nv">y</span><span class="o">=</span><span class="k">$((</span><span class="m">1</span><span class="o">+</span>x<span class="k">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h4 id="final-exploit">Final Exploit</h4>
<p>The final payload leverages array indexing to trigger command execution and redirects the flag output directly to the main process stdout.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="m">0</span> + a<span class="o">[</span><span class="k">$(</span>cat /flag.txt &gt; /proc/1/fd/1<span class="k">)</span><span class="o">]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Explanation:</p>
<ul>
<li><code>a[INDEX]</code> forces Bash to fully expand <code>INDEX</code>,</li>
<li><code>$()</code> inside <code>INDEX</code> is executed,</li>
<li>output is redirected to <code>/proc/1/fd/1</code>, which corresponds to stdout of PID 1,</li>
<li>PID 1 holds the socket connected to <code>nc</code>, so the flag is sent directly to the client.</li>
</ul>
<h4 id="flag">Flag</h4>
<pre tabindex="0"><code>uoftctf{you_won_the_LETtery_(hahahaha_get_it???)}
</code></pre><h2 id="chal-2">Chal 2</h2>

            </div>
        
            <div class="article-footer mt-5 pt-4" style="font-size: smaller;">
                <p>Thanks for your reading!</p>
                <p>© 2026 <strong>izcuyt.com</strong>. Some rights reserved.</p>
            </div>
        </article>
        <aside class="main-content__article-panel col-md-3">
            
            
            <div class="main-content__article-panel-same-category-post">
                <h3 class="main-content__article-panel-heading">
                    <i class="fa-regular fa-newspaper"></i>Related articles
                </h3>
                <ul class="main-content__article-panel-list">
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/2026/01/writeup-web-cybersecurity-student-contest-vietnam-2025/" title="Writeup (Web) Cybersecurity Student Contest Vietnam 2025">
                                <span class="main-content__article-panel-item-text">Writeup (Web) Cybersecurity Student Contest Vietnam 2025</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/2025/12/file-upload-challenge/" title="File Upload Challenge">
                                <span class="main-content__article-panel-item-text">File Upload Challenge</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/2025/12/tim-hieu-ve-sql-injection-va-cach-phong-chong/" title="Tìm hiểu về SQL injection và cách phòng chống">
                                <span class="main-content__article-panel-item-text">Tìm hiểu về SQL injection và cách phòng chống</span>
                            </a>
                        </li>
                    
                </ul>
            </div>
            

            <div class="main-content__article-panel-categories">
                <h3 class="main-content__article-panel-heading">
                    <i class="fa-solid fa-hashtag"></i> Categories
                </h3>
                <ul class="main-content__article-panel-list">
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/file-uploads-vulnerabilities">
                                
                                <span class="main-content__article-panel-item-text">File Uploads Vulnerabilities</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/security">
                                
                                <span class="main-content__article-panel-item-text">Security</span>
                                <span class="main-content__article-panel-item-text cat-count">(4)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/sql-injection">
                                
                                <span class="main-content__article-panel-item-text">SQL Injection</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/web">
                                
                                <span class="main-content__article-panel-item-text">Web</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/writeups">
                                
                                <span class="main-content__article-panel-item-text">Writeups</span>
                                <span class="main-content__article-panel-item-text cat-count">(2)</span>
                            </a>
                        </li>
                    
                </ul>
            </div>

            
                <div class="main-content__article-panel-toc">
                    <h3 class="main-content__article-panel-heading">
                        <i class="fa-regular fa-rectangle-list"></i>Contents
                    </h3>
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#chal-1">Chal 1</a>
      <ul>
        <li><a href="#description">Description</a></li>
        <li><a href="#source-analysis">Source Analysis</a></li>
        <li><a href="#solution">Solution</a></li>
      </ul>
    </li>
    <li><a href="#chal-2">Chal 2</a></li>
  </ul>
</nav>
                </div>
            

        </aside>
    </div>

        </div>

        <footer id="main-footer" class="pt-4 pb-4">
    <div class="container container-narrow border-top main-footer__wrapper">
        <div class="row">
            <div class="col-lg-5">
                <div class="footer-brand">
                    <h2 class="footer-brand__name">>_ izcuyt.com</h2>
                    <p class="footer-brand__desc">
                        Aspiring Web Pentester<br>Sharing security knowledge about Cyber Security.
                        <br><br>
                        Made by <b>@cuyt</b> with love. ♥️
                    </p>
                </div>
                <div class="main-footer__footer-socials">
                    <a href="https://github.com/quyt0"
                        target="_blank" rel="noopener"
                        class="footer-social-btn"
                        aria-label="GitHub profile">
                        <i class="fa-brands fa-github" aria-hidden="true"></i>
                    </a>
                    <a href="https://www.facebook.com/100024860571867"
                        target="_blank" rel="noopener"
                        class="footer-social-btn"
                        aria-label="Facebook profile">
                        <i class="fa-brands fa-facebook" aria-hidden="true"></i>
                    </a>

                    <a href="https://www.instagram.com/koanbunbo/"
                        target="_blank" rel="noopener"
                        class="footer-social-btn"
                        aria-label="Instagram profile">
                        <i class="fa-brands fa-instagram" aria-hidden="true"></i>
                    </a>

                    <a href="https://www.linkedin.com/in/doanduyphuc/"
                        target="_blank" rel="noopener"
                        class="footer-social-btn"
                        aria-label="LinkedIn profile">
                        <i class="fa-brands fa-linkedin" aria-hidden="true"></i>
                    </a>

                    <a href="mailto:dphuc2304@gmail.com"
                        class="footer-social-btn"
                        aria-label="Send email to dphuc2304@gmail.com">
                        <i class="fa-solid fa-envelope" aria-hidden="true"></i>
                    </a>

                    </div>
            </div>

            <div class="col-lg-1 d-none d-lg-block">
                <div class="footer-divider"></div>
            </div>

            <div class="col-6 col-lg-3">
                <h3 class="footer-title">This site</h3>
                <ul class="footer-list">
                    <li><a href="/">Blog</a></li>
                    <li><a href="/categories">Categories</a></li>
                    <li><a href="/archives">Archives</a></li>
                </ul>
            </div>

            <div class="col-6 col-lg-3">
                <h3 class="footer-title">Connect</h3>
                <ul class="footer-list">
                    <li><a href="/cv">Resume</a></li>
                    <li><a href="mailto:dphuc2304@gmail.com">Email</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
    </main>
    <div id="lightbox-overlay" class="lightbox-overlay">
        <span class="lightbox-close">&times;</span>
        <img class="lightbox-content" id="lightbox-img">
        <div id="lightbox-caption"></div>
    </div>
    
    <script src="/js/script.min.7c8827ed031431dc353d44474f721aff9bc71ab4a1d70a149f3b4d68eb775164.js" integrity="sha256-fIgn7QMUMdw1PURHT3Ia/5vHGrSh1woUnztNaOt3UWQ=" defer></script>
</body>
</html>